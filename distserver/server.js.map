{
  "version": 3,
  "sources": ["../server/server.ts"],
  "sourcesContent": ["import morgan from 'morgan';\r\nimport compression from 'compression';\r\nimport bodyParser from 'body-parser';\r\nimport helmet from 'helmet';\r\nimport throng from 'throng';\r\nimport memored from 'memored';\r\nimport Arweave from 'arweave';\r\nimport App from './app';\r\nimport HomeController from './controllers/home';\r\nimport CacheController from './controllers/caching';\r\nimport RedirectController from './controllers/redirection';\r\n\r\nconst arweave = Arweave.init({\r\n  host: 'arweave.net',\r\n  protocol: 'https',\r\n  port: 443\r\n});\r\n\r\nconst worker = (id: string, disconnect: any) => {\r\n  console.log(`Started worker ${id}`);\r\n\r\n  const app = new App({\r\n    port: 5000,\r\n    controllers: [new HomeController(arweave), new CacheController(arweave), new RedirectController()],\r\n    middleWares: [\r\n      morgan('tiny'),\r\n      bodyParser.json(),\r\n      bodyParser.urlencoded({ extended: true }),\r\n      compression(),\r\n      helmet({\r\n        contentSecurityPolicy: false,\r\n      })\r\n    ],\r\n  });\r\n\r\n  app.listen();\r\n\r\n  process.on('SIGTERM', () => {\r\n    console.log(`Worker ${id} exiting (cleanup here)`);\r\n    disconnect();\r\n  });\r\n};\r\n\r\nmemored.setup({\r\n  purgeInterval: 1000 * 60 * 60 * 0.5, // 30 mins\r\n});\r\n\r\nconst WORKERS = +(process.env.WEB_CONCURRENCY || 1);\r\nthrong({\r\n  count: WORKERS,\r\n  lifetime: Infinity,\r\n  // @ts-ignore\r\n  worker,\r\n});\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;AAAA,oBAAmB;AACnB,yBAAwB;AACxB,yBAAuB;AACvB,oBAAmB;AACnB,oBAAmB;AACnB,qBAAoB;AACpB,qBAAoB;AACpB,iBAAgB;AAChB,kBAA2B;AAC3B,qBAA4B;AAC5B,yBAA+B;AAE/B,MAAM,UAAU,uBAAQ,KAAK;AAAA,EAC3B,MAAM;AAAA,EACN,UAAU;AAAA,EACV,MAAM;AAAA;AAGR,MAAM,SAAS,CAAC,IAAY;AAC1B,UAAQ,IAAI,kBAAkB;AAE9B,QAAM,MAAM,IAAI,mBAAI;AAAA,IAClB,MAAM;AAAA,IACN,aAAa,CAAC,IAAI,oBAAe,UAAU,IAAI,uBAAgB,UAAU,IAAI;AAAA,IAC7E,aAAa;AAAA,MACX,sBAAO;AAAA,MACP,2BAAW;AAAA,MACX,2BAAW,WAAW,CAAE,UAAU;AAAA,MAClC;AAAA,MACA,sBAAO;AAAA,QACL,uBAAuB;AAAA;AAAA;AAAA;AAK7B,MAAI;AAEJ,UAAQ,GAAG,WAAW;AACpB,YAAQ,IAAI,UAAU;AACtB;AAAA;AAAA;AAIJ,uBAAQ,MAAM;AAAA,EACZ,eAAe,MAAO,KAAK,KAAK;AAAA;AAGlC,MAAM,UAAU,CAAE,SAAQ,IAAI,mBAAmB;AACjD,sBAAO;AAAA,EACL,OAAO;AAAA,EACP,UAAU;AAAA,EAEV;AAAA;",
  "names": []
}
